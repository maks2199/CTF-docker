## Рассмотреть вопросы

1. В каких случаях вообще контейнер может быть запущен небезопасно, зачем запускать с privelleged?

- Разработка и тестрирование, работа с ядром и драйверами, иссоедование уязвимостей

2. Как злоумышленник может получить доступ к конетейнеру?

- уязвимости в приложениях внутри контейнера
- уязвимости в пакетах/библиотеках (Supply Chain Attack)
- утечка credentials

3. В каких случаях может быть примонтирован docker socket?

- В ci/cd, чтобы собирать образы
- В инструментах управления контейнерами (интерфейсах)
- Для мониторинга (Prometheus)

4. Как во втором задании я полчуил доступ к /root/flag.txt я ведь не монтировал его внутрь первого контейнера?

```
Docker socket — это не файл с данными, а API для управления Docker daemon.
Когда ты выполняешь docker run ... из контейнера A:

1. Команда идёт через сокет к Docker daemon на хосте
2. Daemon работает с root-правами на хосте
3. Daemon создаёт новый контейнер B (не внутри A, а рядом с ним!)
4. В контейнер B монтируется -v /:/host — вся файловая система хоста
5. chroot /host делает корнем ФС хоста

Ты как бы "попросил" хостовый Docker daemon создать контейнер с доступом к хосту. И он послушно это сделал, потому что у daemon'а есть на это права.

Аналогия
Представь: ты сидишь в комнате (контейнер A), но у тебя есть телефон директора здания (docker.sock). Ты звонишь и говоришь: "Создай мне новую комнату с дверью во все остальные помещения". Директор (daemon) отвечает: "Окей" — и делает. Теперь ты выходишь в эту новую комнату и имеешь доступ ко всему зданию.
```

4. Что такое docker.sock?  
   docker.sock - это Unix-сокет, основной канал связи между Docker-клиентом (например, командой docker в терминале) и Docker Daemon (dockerd), который управляет контейнерами, образами, сетями и томами на хосте. Предоставление доступа к этому файлу контейнеру равносильно неограниченному root-доступу к узлу, что представляет серьезную угрозу безопасности

## TODO:

- [ ] Проверить все практические задания
- [ ] Рассмотреть способы скинирования
- [ ] Статья в ТГ
- [ ] Рассмотреть buildkit
- [ ] Проверить примеры инцидентов, найти источники
- [ ] Пройтись по всей презентации и задать себе вопросы
- [ ] Показать презентацию кому-то еще

## From selab

### Уязвимости контейнеров

- доступ к хостовой машине
- утечка секретов (env)

### Уменьшение поверхности атаки

- запуск от non-root user, ограничение Linux capabilities
- использование .dockerignore,

### Что можно испортить

- Вмешаться в разрешение имён в /etc/hosts или /etc/resolv.conf, чтобы установить соединение с вредоносным сервером без поиска.
- Взломать пароли из /etc/shadow или изменить назначение учётных записей в /etc/passwd.
- Заменить доверенный исполняемый файл на уже скомпрометированный.
- Внести изменения в файлы в загрузочном разделе, чтобы изменить ядро ​​или загрузчик.
- Отредактировать файлы конфигурации сервера, чтобы изменить его поведение.

### Уязвимости Docker

- контейнеры не изолированы полностью, есть риск побега и эскалации прав
- Non-root user
- Ограничения --cap-drop=ALL --cap-add, read-only
- .dockerignore для чувствительных данных
